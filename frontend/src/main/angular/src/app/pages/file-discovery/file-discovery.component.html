<div class="card">
  <div class="card-body">
    <h1 class="card-title">File discovery</h1>

    <p>
      Here you can manage all of the new files that have been found but have not yet been scheduled for download.
    </p>

    <p>
      Status:
      <span class="badge"
            [ngClass]="{'bg-success': discoveryOngoing, 'bg-secondary': !discoveryOngoing}">
        <i class="me-1"
           [ngClass]="{'bi bi-check-circle': discoveryOngoing, 'bi bi-x-circle': !discoveryOngoing}"
           aria-hidden="true">
        </i>

        <ng-container *ngIf="discoveryOngoing">Discovery in progress</ng-container>
        <ng-container *ngIf="!discoveryOngoing">Last run: xx.xx.xxxx</ng-container>
      </span>
    </p>

    <p>
      <button class="btn btn-primary me-3" (click)="discoverFiles()">Discover new files</button>
    </p>
    <p>
      <button class="btn btn-secondary" (click)="refresh()">Refresh discovered files</button>
    </p>

    <div *ngIf="newestDiscovered">
      <table class="table table-custom-responsive-lg-down" *ngIf="discoveredFiles?.content?.length">
        <caption>Newest discovered file</caption>
        <thead>
        <tr>
          <th scope="col">Game title</th>
          <th scope="col">File name</th>
          <th scope="col">Size</th>
          <th scope="col">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td data-title="Game title">
            {{newestDiscovered.gameTitle}}
          </td>

          <td data-title="File name">
            {{newestDiscovered.name}}
          </td>

          <td data-title="Size">
            {{newestDiscovered.size}}
          </td>

          <td class="hide-title actions">
            <button (click)="enqueueFile(newestDiscovered.uniqueId)" class="btn btn-primary">Enqueue</button>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <app-loaded-content [isLoading]="filesAreLoading">
      <table class="table table-custom-responsive-lg-down" *ngIf="discoveredFiles?.content?.length">
        <caption>Discovered files</caption>
        <thead>
        <tr>
          <th scope="col">Game title</th>
          <th scope="col">File name</th>
          <th scope="col">Size</th>
          <th scope="col">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let file of discoveredFiles?.content">
          <td data-title="Game title">
            {{file.gameTitle}}
          </td>

          <td data-title="File name">
            {{file.name}}
          </td>

          <td data-title="Size">
            {{file.size}}
          </td>

          <td class="hide-title actions">
            <button (click)="enqueueFile(file.uniqueId)" class="btn btn-primary">Enqueue</button>
          </td>
        </tr>
        </tbody>
      </table>
    </app-loaded-content>
  </div>
</div>
